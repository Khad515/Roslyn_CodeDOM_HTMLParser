using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp;
using Microsoft.CodeAnalysis.CSharp.Syntax;
using Microsoft.CSharp;
using System.Diagnostics;
using System.IO;
using System.Data;
using System.CodeDom.Compiler;
using System.Windows.Forms;

namespace RoslynCodeDOM_OOKP_WinForm
{
    class CodeGenerator
    {

        public string GenerateCode()
        {
            CompilationUnitSyntax tree = SyntaxFactory.CompilationUnit()
                .WithUsings
                (
                    SyntaxFactory.List<UsingDirectiveSyntax>
                    (
                        new UsingDirectiveSyntax[]
                        {
                            SyntaxFactory.UsingDirective
                            (
                                SyntaxFactory.IdentifierName("System")
                            ),
                            SyntaxFactory.UsingDirective
                            (
                                SyntaxFactory.QualifiedName
                                (
                                    SyntaxFactory.QualifiedName
                                    (
                                        SyntaxFactory.IdentifierName("System"), SyntaxFactory.IdentifierName("Collections")
                                    ),
                                    SyntaxFactory.IdentifierName("Generic")
                                )
                            )
                        }
                    )
                )
                .WithMembers
                (
                    SyntaxFactory.SingletonList<MemberDeclarationSyntax>
                    (
                        SyntaxFactory.NamespaceDeclaration
                        (
                            SyntaxFactory.IdentifierName("OOKP_Template_Console_App")
                        )
                        .WithMembers
                        (
                            SyntaxFactory.SingletonList<MemberDeclarationSyntax>
                            (
                                SyntaxFactory.ClassDeclaration("Program")
                                .WithMembers
                                (
                                    SyntaxFactory.SingletonList<MemberDeclarationSyntax>
                                    (
                                        SyntaxFactory.MethodDeclaration
                                        (
                                            SyntaxFactory.PredefinedType(SyntaxFactory.Token(SyntaxKind.VoidKeyword)), SyntaxFactory.Identifier("Main")
                                        )
                                        .WithModifiers
                                        (
                                            SyntaxFactory.TokenList(SyntaxFactory.Token(SyntaxKind.StaticKeyword))
                                        )
                                        .WithParameterList
                                        (
                                            SyntaxFactory.ParameterList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                                (
                                                    SyntaxFactory.Parameter(SyntaxFactory.Identifier("args"))
                                                    .WithType
                                                    (
                                                         SyntaxFactory.ArrayType
                                                         (
                                                             SyntaxFactory.PredefinedType(SyntaxFactory.Token(SyntaxKind.StringKeyword))
                                                         )
                                                         .WithRankSpecifiers
                                                         (
                                                             SyntaxFactory.SingletonList<ArrayRankSpecifierSyntax>
                                                             (
                                                                 SyntaxFactory.ArrayRankSpecifier
                                                                 (
                                                                     SyntaxFactory.SingletonSeparatedList<ExpressionSyntax>(SyntaxFactory.OmittedArraySizeExpression())
                                                                 )
                                                             )
                                                         )
                                                     )
                                                )
                                            )
                                        )
                                        .WithBody
                                        (
                                            SyntaxFactory.Block
                                            (
                                                SyntaxFactory.LocalDeclarationStatement
                                                (
                                                    SyntaxFactory.VariableDeclaration
                                                    (
                                                        SyntaxFactory.GenericName(SyntaxFactory.Identifier("List"))
                                                        .WithTypeArgumentList
                                                        (
                                                            SyntaxFactory.TypeArgumentList
                                                            (
                                                                SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                (
                                                                    SyntaxFactory.PredefinedType(SyntaxFactory.Token(SyntaxKind.StringKeyword))
                                                                )
                                                            )
                                                        )
                                                    )
                                                    .WithVariables
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                        (
                                                            SyntaxFactory.VariableDeclarator(SyntaxFactory.Identifier("exp_list"))
                                                            .WithInitializer
                                                            (
                                                                SyntaxFactory.EqualsValueClause
                                                                (
                                                                    SyntaxFactory.ObjectCreationExpression
                                                                    (
                                                                        SyntaxFactory.GenericName(SyntaxFactory.Identifier("List"))
                                                                        .WithTypeArgumentList
                                                                        (
                                                                            SyntaxFactory.TypeArgumentList
                                                                            (
                                                                                SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                                (
                                                                                    SyntaxFactory.PredefinedType(SyntaxFactory.Token(SyntaxKind.StringKeyword))
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                    .WithInitializer
                                                                    (
                                                                        SyntaxFactory.InitializerExpression
                                                                        (
                                                                            SyntaxKind.CollectionInitializerExpression,
                                                                            SyntaxFactory.SeparatedList<ExpressionSyntax>
                                                                            (
                                                                                new SyntaxNodeOrToken[] 
                                                                                {
                                                                                    SyntaxFactory.LiteralExpression(SyntaxKind.StringLiteralExpression, SyntaxFactory.Literal("Begin")),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.LiteralExpression(SyntaxKind.StringLiteralExpression, SyntaxFactory.Literal("Hello")),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.LiteralExpression(SyntaxKind.StringLiteralExpression, SyntaxFactory.Literal("World")),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.LiteralExpression(SyntaxKind.StringLiteralExpression, SyntaxFactory.Literal("!")),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.LiteralExpression(SyntaxKind.StringLiteralExpression, SyntaxFactory.Literal("Worked!")),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.LiteralExpression(SyntaxKind.StringLiteralExpression, SyntaxFactory.Literal("End"))
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.ForEachStatement
                                                (
                                                    SyntaxFactory.IdentifierName("var"),
                                                    SyntaxFactory.Identifier("exp"),
                                                    SyntaxFactory.IdentifierName("exp_list"),
                                                    SyntaxFactory.Block
                                                    (
                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                        (
                                                            SyntaxFactory.ExpressionStatement
                                                            (
                                                                SyntaxFactory.InvocationExpression
                                                                (
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.IdentifierName("Console"),
                                                                        SyntaxFactory.IdentifierName("WriteLine")
                                                                    )
                                                                )
                                                                .WithArgumentList
                                                                (
                                                                    SyntaxFactory.ArgumentList
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                        (
                                                                            SyntaxFactory.Argument(SyntaxFactory.IdentifierName("exp"))
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ), 
                                                SyntaxFactory.ExpressionStatement
                                                (
                                                    SyntaxFactory.InvocationExpression
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.IdentifierName("Console"),
                                                            SyntaxFactory.IdentifierName("ReadKey")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
                .NormalizeWhitespace();

            string code = tree.ToFullString();

            return code;
        }

        public void SaveFile(string code)
        {
            string path = Directory.GetCurrentDirectory() + @"\Temp\Program.cs";
            File.WriteAllText(path, code);
        }

        

        public string CompileHTMLCode(string code, string ComVersion)
        {
            string status = "";
            CSharpCodeProvider csc = new CSharpCodeProvider(new Dictionary<string, string>() { { "CompilerVersion", ComVersion } });
            CompilerParameters parameters = new CompilerParameters
            (
                new[] 
                {
                    "Microsoft.CSharp.dll",
                    "mscorlib.dll",
                    "System.dll",
                    "System.Core.dll",
                    "System.Net.Http.dll",
                    "System.Xml.dll",
                    "System.Xml.Linq.dll",
                    "HtmlAgilityPack.dll"
                },
                @"Temp\App.exe",
                true
                );
            parameters.GenerateExecutable = true;
            CompilerResults results = csc.CompileAssemblyFromSource(parameters, code);
            if (results.Errors.HasErrors)
            {
                results.Errors.Cast<CompilerError>().ToList().ForEach(error => status += error.ErrorText + "\r\n");
            }
            else
            {
                status = "-----Build succeeded------";
                Process.Start(Application.StartupPath + "/Temp/App.exe");
            }
            return status;
        }

        public string GenerateHTMLParse_Code()
        {
            CompilationUnitSyntax tree = SyntaxFactory.CompilationUnit()
            .WithUsings
            (
                SyntaxFactory.List<UsingDirectiveSyntax>
                (
                    new UsingDirectiveSyntax[]
                    {
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.IdentifierName("HtmlAgilityPack")
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.IdentifierName("System")
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.QualifiedName
                            (
                                SyntaxFactory.QualifiedName
                                (
                                    SyntaxFactory.IdentifierName("System"),
                                    SyntaxFactory.IdentifierName("Collections")
                                ),
                                SyntaxFactory.IdentifierName("Generic")
                            )
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.QualifiedName
                            (
                                SyntaxFactory.IdentifierName("System"),
                                SyntaxFactory.IdentifierName("Linq")
                            )
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.QualifiedName
                            (
                                SyntaxFactory.IdentifierName("System"),
                                SyntaxFactory.IdentifierName("Threading")
                            )
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.QualifiedName
                            (
                                SyntaxFactory.IdentifierName("System"),
                                SyntaxFactory.IdentifierName("Diagnostics")
                            )
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.QualifiedName
                            (
                                SyntaxFactory.QualifiedName
                                (
                                    SyntaxFactory.IdentifierName("System"),
                                    SyntaxFactory.IdentifierName("Xml")
                                ),
                                SyntaxFactory.IdentifierName("Serialization")
                            )
                        ),
                        SyntaxFactory.UsingDirective
                        (
                            SyntaxFactory.QualifiedName
                            (
                                SyntaxFactory.IdentifierName("System"),
                                SyntaxFactory.IdentifierName("IO")
                            )
                        )
                    }
                )
            )
.WithMembers
(
    SyntaxFactory.SingletonList<MemberDeclarationSyntax>
    (
        SyntaxFactory.NamespaceDeclaration
        (
            SyntaxFactory.IdentifierName("HTMLParse_HTMLAgilityPack_Template")
        )
        .WithMembers
        (
            //SyntaxFactory.SingletonList<MemberDeclarationSyntax>
            SyntaxFactory.List<MemberDeclarationSyntax>
            (
                new MemberDeclarationSyntax[]
                {

                SyntaxFactory.ClassDeclaration("Program")
                .WithMembers
                (
                    SyntaxFactory.List<MemberDeclarationSyntax>
                    (
                        new MemberDeclarationSyntax[]
                        {
                            SyntaxFactory.FieldDeclaration
                            (
                                SyntaxFactory.VariableDeclaration
                                (
                                    SyntaxFactory.GenericName
                                    (
                                        SyntaxFactory.Identifier("List")
                                    )
                                    .WithTypeArgumentList
                                    (
                                        SyntaxFactory.TypeArgumentList
                                        (
                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                            (
                                                SyntaxFactory.IdentifierName("HtmlDocument")
                                            )
                                        )
                                    )
                                )
                                .WithVariables
                                (
                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                    (
                                        SyntaxFactory.VariableDeclarator
                                        (
                                            SyntaxFactory.Identifier("doc_html_List")
                                        )
                                        .WithInitializer
                                        (
                                            SyntaxFactory.EqualsValueClause
                                            (
                                                SyntaxFactory.ObjectCreationExpression
                                                (
                                                    SyntaxFactory.GenericName
                                                    (
                                                        SyntaxFactory.Identifier("List")
                                                    )
                                                    .WithTypeArgumentList
                                                    (
                                                        SyntaxFactory.TypeArgumentList
                                                        (
                                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                            (
                                                                SyntaxFactory.IdentifierName("HtmlDocument")
                                                            )
                                                        )
                                                    )
                                                )
                                                .WithArgumentList
                                                (
                                                    SyntaxFactory.ArgumentList()
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PrivateKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            ),
                            SyntaxFactory.FieldDeclaration
                            (
                                SyntaxFactory.VariableDeclaration
                                (
                                    SyntaxFactory.GenericName
                                    (
                                        SyntaxFactory.Identifier("Dictionary")
                                    )
                                    .WithTypeArgumentList
                                    (
                                        SyntaxFactory.TypeArgumentList
                                        (
                                            SyntaxFactory.SeparatedList<TypeSyntax>
                                            (
                                                new SyntaxNodeOrToken[]
                                                {
                                                    SyntaxFactory.PredefinedType
                                                    (
                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                    ),
                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                    SyntaxFactory.IdentifierName("HtmlDocument")
                                                }
                                            )
                                        )
                                    )
                                )
                                .WithVariables
                                (
                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                    (
                                        SyntaxFactory.VariableDeclarator
                                        (
                                            SyntaxFactory.Identifier("doc_html_Dic")
                                        )
                                        .WithInitializer
                                        (
                                            SyntaxFactory.EqualsValueClause
                                            (
                                                SyntaxFactory.ObjectCreationExpression
                                                (
                                                    SyntaxFactory.GenericName
                                                    (
                                                        SyntaxFactory.Identifier("Dictionary")
                                                    )
                                                    .WithTypeArgumentList
                                                    (
                                                        SyntaxFactory.TypeArgumentList
                                                        (
                                                            SyntaxFactory.SeparatedList<TypeSyntax>
                                                            (
                                                                new SyntaxNodeOrToken[]
                                                                {
                                                                    SyntaxFactory.PredefinedType
                                                                    (
                                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                    ),
                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                    SyntaxFactory.IdentifierName("HtmlDocument")
                                                                }
                                                            )
                                                        )
                                                    )
                                                )
                                                .WithArgumentList
                                                (
                                                    SyntaxFactory.ArgumentList()
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PrivateKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            ),
                            SyntaxFactory.FieldDeclaration
                            (
                                SyntaxFactory.VariableDeclaration
                                (
                                    SyntaxFactory.GenericName
                                    (
                                        SyntaxFactory.Identifier("List")
                                    )
                                    .WithTypeArgumentList
                                    (
                                        SyntaxFactory.TypeArgumentList
                                        (
                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                            (
                                                SyntaxFactory.PredefinedType
                                                (
                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                )
                                            )
                                        )
                                    )
                                )
                                .WithVariables
                                (
                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                    (
                                        SyntaxFactory.VariableDeclarator
                                        (
                                            SyntaxFactory.Identifier("html_adress_list")
                                        )
                                        .WithInitializer
                                        (
                                            SyntaxFactory.EqualsValueClause
                                            (
                                                SyntaxFactory.ObjectCreationExpression
                                                (
                                                    SyntaxFactory.GenericName
                                                    (
                                                        SyntaxFactory.Identifier("List")
                                                    )
                                                    .WithTypeArgumentList
                                                    (
                                                        SyntaxFactory.TypeArgumentList
                                                        (
                                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                            (
                                                                SyntaxFactory.PredefinedType
                                                                (
                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                                .WithArgumentList
                                                (
                                                    SyntaxFactory.ArgumentList()
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PrivateKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            ),
                            SyntaxFactory.FieldDeclaration
                            (
                                SyntaxFactory.VariableDeclaration
                                (
                                    SyntaxFactory.GenericName
                                    (
                                        SyntaxFactory.Identifier("List")
                                    )
                                    .WithTypeArgumentList
                                    (
                                        SyntaxFactory.TypeArgumentList
                                        (
                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                            (
                                                SyntaxFactory.IdentifierName("Thread")
                                            )
                                        )
                                    )
                                )
                                .WithVariables
                                (
                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                    (
                                        SyntaxFactory.VariableDeclarator
                                        (
                                            SyntaxFactory.Identifier("th_list")
                                        )
                                        .WithInitializer
                                        (
                                            SyntaxFactory.EqualsValueClause
                                            (
                                                SyntaxFactory.ObjectCreationExpression
                                                (
                                                    SyntaxFactory.GenericName
                                                    (
                                                        SyntaxFactory.Identifier("List")
                                                    )
                                                    .WithTypeArgumentList
                                                    (
                                                        SyntaxFactory.TypeArgumentList
                                                        (
                                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                            (
                                                                SyntaxFactory.IdentifierName("Thread")
                                                            )
                                                        )
                                                    )
                                                )
                                                .WithArgumentList
                                                (
                                                    SyntaxFactory.ArgumentList()
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PrivateKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.PredefinedType
                                (
                                    SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                ),
                                SyntaxFactory.Identifier("Main")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                    (
                                        SyntaxFactory.Parameter
                                        (
                                            SyntaxFactory.Identifier("args")
                                        )
                                        .WithType
                                        (
                                            SyntaxFactory.ArrayType
                                            (
                                                SyntaxFactory.PredefinedType
                                                (
                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                )
                                            )
                                            .WithRankSpecifiers
                                            (
                                                SyntaxFactory.SingletonList<ArrayRankSpecifierSyntax>
                                                (
                                                    SyntaxFactory.ArrayRankSpecifier
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<ExpressionSyntax>
                                                        (
                                                            SyntaxFactory.OmittedArraySizeExpression()
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.AssignmentExpression
                                        (
                                            SyntaxKind.SimpleAssignmentExpression,
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.MemberAccessExpression
                                                (
                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                    SyntaxFactory.IdentifierName("Thread"),
                                                    SyntaxFactory.IdentifierName("CurrentThread")
                                                ),
                                                SyntaxFactory.IdentifierName("Name")
                                            ),
                                            SyntaxFactory.LiteralExpression
                                            (
                                                SyntaxKind.StringLiteralExpression,
                                                SyntaxFactory.Literal("page_0")
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("path")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.BinaryExpression
                                                        (
                                                            SyntaxKind.AddExpression,
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.IdentifierName("Directory"),
                                                                    SyntaxFactory.IdentifierName("GetCurrentDirectory")
                                                                )
                                                            ),
                                                            SyntaxFactory.LiteralExpression
                                                            (
                                                                SyntaxKind.StringLiteralExpression,
                                                                SyntaxFactory.Literal
                                                                (
                                                                    "@\"\\Temp\\Settings.xml\"",
                                                                    "\\Temp\\Settings.xml"
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.IfStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("File"),
                                                SyntaxFactory.IdentifierName("Exists")
                                            )
                                        )
                                        .WithArgumentList
                                        (
                                            SyntaxFactory.ArgumentList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                (
                                                    SyntaxFactory.Argument
                                                    (
                                                        SyntaxFactory.IdentifierName("path")
                                                    )
                                                )
                                            )
                                        ),
                                        SyntaxFactory.Block
                                        (
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.IdentifierName("XmlSerializer")
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("deserializer")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.ObjectCreationExpression
                                                                (
                                                                    SyntaxFactory.IdentifierName("XmlSerializer")
                                                                )
                                                                .WithArgumentList
                                                                (
                                                                    SyntaxFactory.ArgumentList
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                        (
                                                                            SyntaxFactory.Argument
                                                                            (
                                                                                SyntaxFactory.TypeOfExpression
                                                                                (
                                                                                    SyntaxFactory.IdentifierName("Settings")
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.IdentifierName("FileStream")
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("fs")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.ObjectCreationExpression
                                                                (
                                                                    SyntaxFactory.IdentifierName("FileStream")
                                                                )
                                                                .WithArgumentList
                                                                (
                                                                    SyntaxFactory.ArgumentList
                                                                    (
                                                                        SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                        (
                                                                            new SyntaxNodeOrToken[]
                                                                            {
                                                                                SyntaxFactory.Argument
                                                                                (
                                                                                    SyntaxFactory.IdentifierName("path")
                                                                                ),
                                                                                SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                SyntaxFactory.Argument
                                                                                (
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.IdentifierName("FileMode"),
                                                                                        SyntaxFactory.IdentifierName("Open")
                                                                                    )
                                                                                )
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.IdentifierName("Settings")
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("obj1")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.CastExpression
                                                                (
                                                                    SyntaxFactory.IdentifierName("Settings"),
                                                                    SyntaxFactory.InvocationExpression
                                                                    (
                                                                        SyntaxFactory.MemberAccessExpression
                                                                        (
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            SyntaxFactory.IdentifierName("deserializer"),
                                                                            SyntaxFactory.IdentifierName("Deserialize")
                                                                        )
                                                                    )
                                                                    .WithArgumentList
                                                                    (
                                                                        SyntaxFactory.ArgumentList
                                                                        (
                                                                            SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                            (
                                                                                SyntaxFactory.Argument
                                                                                (
                                                                                    SyntaxFactory.IdentifierName("fs")
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.PredefinedType
                                                    (
                                                        SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                                    )
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("values")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.IdentifierName("obj1"),
                                                                    SyntaxFactory.IdentifierName("values")
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.PredefinedType
                                                    (
                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                    )
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("xpath")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.IdentifierName("obj1"),
                                                                    SyntaxFactory.IdentifierName("xpath")
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.GenericName
                                                    (
                                                        SyntaxFactory.Identifier("List")
                                                    )
                                                    .WithTypeArgumentList
                                                    (
                                                        SyntaxFactory.TypeArgumentList
                                                        (
                                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                            (
                                                                SyntaxFactory.PredefinedType
                                                                (
                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("html_list")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.IdentifierName("obj1"),
                                                                    SyntaxFactory.IdentifierName("HTML")
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("html_adress_list"),
                                                    SyntaxFactory.IdentifierName("html_list")
                                                )
                                            ),
                                            SyntaxFactory.LocalDeclarationStatement
                                            (
                                                SyntaxFactory.VariableDeclaration
                                                (
                                                    SyntaxFactory.GenericName
                                                    (
                                                        SyntaxFactory.Identifier("Dictionary")
                                                    )
                                                    .WithTypeArgumentList
                                                    (
                                                        SyntaxFactory.TypeArgumentList
                                                        (
                                                            SyntaxFactory.SeparatedList<TypeSyntax>
                                                            (
                                                                new SyntaxNodeOrToken[]
                                                                {
                                                                    SyntaxFactory.PredefinedType
                                                                    (
                                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                    ),
                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                    SyntaxFactory.GenericName
                                                                    (
                                                                        SyntaxFactory.Identifier("List")
                                                                    )
                                                                    .WithTypeArgumentList
                                                                    (
                                                                        SyntaxFactory.TypeArgumentList
                                                                        (
                                                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                            (
                                                                                SyntaxFactory.PredefinedType
                                                                                (
                                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    )
                                                )
                                                .WithVariables
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                    (
                                                        SyntaxFactory.VariableDeclarator
                                                        (
                                                            SyntaxFactory.Identifier("pages_list")
                                                        )
                                                        .WithInitializer
                                                        (
                                                            SyntaxFactory.EqualsValueClause
                                                            (
                                                                SyntaxFactory.ObjectCreationExpression
                                                                (
                                                                    SyntaxFactory.GenericName
                                                                    (
                                                                        SyntaxFactory.Identifier("Dictionary")
                                                                    )
                                                                    .WithTypeArgumentList
                                                                    (
                                                                        SyntaxFactory.TypeArgumentList
                                                                        (
                                                                            SyntaxFactory.SeparatedList<TypeSyntax>
                                                                            (
                                                                                new SyntaxNodeOrToken[]
                                                                                {
                                                                                    SyntaxFactory.PredefinedType
                                                                                    (
                                                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                    ),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.GenericName
                                                                                    (
                                                                                        SyntaxFactory.Identifier("List")
                                                                                    )
                                                                                    .WithTypeArgumentList
                                                                                    (
                                                                                        SyntaxFactory.TypeArgumentList
                                                                                        (
                                                                                            SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                                            (
                                                                                                SyntaxFactory.PredefinedType
                                                                                                (
                                                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                                .WithArgumentList
                                                                (
                                                                    SyntaxFactory.ArgumentList()
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.IfStatement
                                            (
                                                SyntaxFactory.BinaryExpression
                                                (
                                                    SyntaxKind.EqualsExpression,
                                                    SyntaxFactory.MemberAccessExpression
                                                    (
                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                        SyntaxFactory.IdentifierName("html_list"),
                                                        SyntaxFactory.IdentifierName("Count")
                                                    ),
                                                    SyntaxFactory.LiteralExpression
                                                    (
                                                        SyntaxKind.NumericLiteralExpression,
                                                        SyntaxFactory.Literal(1)
                                                    )
                                                ),
                                                SyntaxFactory.Block
                                                (
                                                    SyntaxFactory.LocalDeclarationStatement
                                                    (
                                                        SyntaxFactory.VariableDeclaration
                                                        (
                                                            SyntaxFactory.PredefinedType
                                                            (
                                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                            )
                                                        )
                                                        .WithVariables
                                                        (
                                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                            (
                                                                SyntaxFactory.VariableDeclarator
                                                                (
                                                                    SyntaxFactory.Identifier("html")
                                                                )
                                                                .WithInitializer
                                                                (
                                                                    SyntaxFactory.EqualsValueClause
                                                                    (
                                                                        SyntaxFactory.ElementAccessExpression
                                                                        (
                                                                            SyntaxFactory.IdentifierName("html_list")
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.BracketedArgumentList
                                                                            (
                                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.LiteralExpression
                                                                                        (
                                                                                            SyntaxKind.NumericLiteralExpression,
                                                                                            SyntaxFactory.Literal(0)
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    SyntaxFactory.ExpressionStatement
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.IdentifierName("LoadDoc")
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList
                                                            (
                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                (
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.IdentifierName("html")
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    SyntaxFactory.ExpressionStatement
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.IdentifierName("pages_list"),
                                                                SyntaxFactory.IdentifierName("Add")
                                                            )
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList
                                                            (
                                                                SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                (
                                                                    new SyntaxNodeOrToken[]
                                                                    {
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.LiteralExpression
                                                                            (
                                                                                SyntaxKind.StringLiteralExpression,
                                                                                SyntaxFactory.Literal("page_1")
                                                                            )
                                                                        ),
                                                                        SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.InvocationExpression
                                                                            (
                                                                                SyntaxFactory.IdentifierName("GetValuesList")
                                                                            )
                                                                            .WithArgumentList
                                                                            (
                                                                                SyntaxFactory.ArgumentList
                                                                                (
                                                                                    SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                                    (
                                                                                        new SyntaxNodeOrToken[]
                                                                                        {
                                                                                            SyntaxFactory.Argument
                                                                                            (
                                                                                                SyntaxFactory.ElementAccessExpression
                                                                                                (
                                                                                                    SyntaxFactory.IdentifierName("doc_html_Dic")
                                                                                                )
                                                                                                .WithArgumentList
                                                                                                (
                                                                                                    SyntaxFactory.BracketedArgumentList
                                                                                                    (
                                                                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                                        (
                                                                                                            SyntaxFactory.Argument
                                                                                                            (
                                                                                                                SyntaxFactory.LiteralExpression
                                                                                                                (
                                                                                                                    SyntaxKind.StringLiteralExpression,
                                                                                                                    SyntaxFactory.Literal("page_0")
                                                                                                                )
                                                                                                            )
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            ),
                                                                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                            SyntaxFactory.Argument
                                                                                            (
                                                                                                SyntaxFactory.IdentifierName("values")
                                                                                            ),
                                                                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                            SyntaxFactory.Argument
                                                                                            (
                                                                                                SyntaxFactory.IdentifierName("xpath")
                                                                                            )
                                                                                        }
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    SyntaxFactory.ExpressionStatement
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.IdentifierName("SaveInfoToFile")
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList
                                                            (
                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                (
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.IdentifierName("pages_list")
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                            .WithElse
                                            (
                                                SyntaxFactory.ElseClause
                                                (
                                                    SyntaxFactory.Block
                                                    (
                                                        SyntaxFactory.LocalDeclarationStatement
                                                        (
                                                            SyntaxFactory.VariableDeclaration
                                                            (
                                                                SyntaxFactory.PredefinedType
                                                                (
                                                                    SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                                                )
                                                            )
                                                            .WithVariables
                                                            (
                                                                SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                                (
                                                                    SyntaxFactory.VariableDeclarator
                                                                    (
                                                                        SyntaxFactory.Identifier("threads_number_before1")
                                                                    )
                                                                    .WithInitializer
                                                                    (
                                                                        SyntaxFactory.EqualsValueClause
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.InvocationExpression
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.IdentifierName("Process"),
                                                                                            SyntaxFactory.IdentifierName("GetCurrentProcess")
                                                                                        )
                                                                                    ),
                                                                                    SyntaxFactory.IdentifierName("Threads")
                                                                                ),
                                                                                SyntaxFactory.IdentifierName("Count")
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.ExpressionStatement
                                                        (
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.IdentifierName("ThreadLoadDocs")
                                                            )
                                                            .WithArgumentList
                                                            (
                                                                SyntaxFactory.ArgumentList
                                                                (
                                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                    (
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.InvocationExpression
                                                                            (
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.IdentifierName("html_list"),
                                                                                    SyntaxFactory.IdentifierName("Count")
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.ExpressionStatement
                                                        (
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.IdentifierName("LoadDoc")
                                                            )
                                                            .WithArgumentList
                                                            (
                                                                SyntaxFactory.ArgumentList
                                                                (
                                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                    (
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.ElementAccessExpression
                                                                            (
                                                                                SyntaxFactory.IdentifierName("html_adress_list")
                                                                            )
                                                                            .WithArgumentList
                                                                            (
                                                                                SyntaxFactory.BracketedArgumentList
                                                                                (
                                                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                    (
                                                                                        SyntaxFactory.Argument
                                                                                        (
                                                                                            SyntaxFactory.LiteralExpression
                                                                                            (
                                                                                                SyntaxKind.NumericLiteralExpression,
                                                                                                SyntaxFactory.Literal(0)
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.LocalDeclarationStatement
                                                        (
                                                            SyntaxFactory.VariableDeclaration
                                                            (
                                                                SyntaxFactory.GenericName
                                                                (
                                                                    SyntaxFactory.Identifier("Dictionary")
                                                                )
                                                                .WithTypeArgumentList
                                                                (
                                                                    SyntaxFactory.TypeArgumentList
                                                                    (
                                                                        SyntaxFactory.SeparatedList<TypeSyntax>
                                                                        (
                                                                            new SyntaxNodeOrToken[]
                                                                            {
                                                                                SyntaxFactory.PredefinedType
                                                                                (
                                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                ),
                                                                                SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                SyntaxFactory.GenericName
                                                                                (
                                                                                    SyntaxFactory.Identifier("List")
                                                                                )
                                                                                .WithTypeArgumentList
                                                                                (
                                                                                    SyntaxFactory.TypeArgumentList
                                                                                    (
                                                                                        SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                                        (
                                                                                            SyntaxFactory.PredefinedType
                                                                                            (
                                                                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                            .WithVariables
                                                            (
                                                                SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                                (
                                                                    SyntaxFactory.VariableDeclarator
                                                                    (
                                                                        SyntaxFactory.Identifier("values_lists")
                                                                    )
                                                                    .WithInitializer
                                                                    (
                                                                        SyntaxFactory.EqualsValueClause
                                                                        (
                                                                            SyntaxFactory.ObjectCreationExpression
                                                                            (
                                                                                SyntaxFactory.GenericName
                                                                                (
                                                                                    SyntaxFactory.Identifier("Dictionary")
                                                                                )
                                                                                .WithTypeArgumentList
                                                                                (
                                                                                    SyntaxFactory.TypeArgumentList
                                                                                    (
                                                                                        SyntaxFactory.SeparatedList<TypeSyntax>
                                                                                        (
                                                                                            new SyntaxNodeOrToken[]
                                                                                            {
                                                                                                SyntaxFactory.PredefinedType
                                                                                                (
                                                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                                ),
                                                                                                SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                                SyntaxFactory.GenericName
                                                                                                (
                                                                                                    SyntaxFactory.Identifier("List")
                                                                                                )
                                                                                                .WithTypeArgumentList
                                                                                                (
                                                                                                    SyntaxFactory.TypeArgumentList
                                                                                                    (
                                                                                                        SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                                                        (
                                                                                                            SyntaxFactory.PredefinedType
                                                                                                            (
                                                                                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                                            )
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            }
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                            .WithArgumentList
                                                                            (
                                                                                SyntaxFactory.ArgumentList()
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.ExpressionStatement
                                                        (
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.IdentifierName("Wait")
                                                            )
                                                            .WithArgumentList
                                                            (
                                                                SyntaxFactory.ArgumentList
                                                                (
                                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                    (
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.IdentifierName("th_list")
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.ForEachStatement
                                                        (
                                                            SyntaxFactory.IdentifierName("var"),
                                                            SyntaxFactory.Identifier("r"),
                                                            SyntaxFactory.IdentifierName("doc_html_Dic"),
                                                            SyntaxFactory.Block
                                                            (
                                                                SyntaxFactory.SingletonList<StatementSyntax>
                                                                (
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.InvocationExpression
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.IdentifierName("values_lists"),
                                                                                SyntaxFactory.IdentifierName("Add")
                                                                            )
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.ArgumentList
                                                                            (
                                                                                SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    new SyntaxNodeOrToken[]
                                                                                    {
                                                                                        SyntaxFactory.Argument
                                                                                        (
                                                                                            SyntaxFactory.MemberAccessExpression
                                                                                            (
                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                SyntaxFactory.IdentifierName("r"),
                                                                                                SyntaxFactory.IdentifierName("Key")
                                                                                            )
                                                                                        ),
                                                                                        SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                        SyntaxFactory.Argument
                                                                                        (
                                                                                            SyntaxFactory.InvocationExpression
                                                                                            (
                                                                                                SyntaxFactory.IdentifierName("GetValuesList")
                                                                                            )
                                                                                            .WithArgumentList
                                                                                            (
                                                                                                SyntaxFactory.ArgumentList
                                                                                                (
                                                                                                    SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                                                    (
                                                                                                        new SyntaxNodeOrToken[]
                                                                                                        {
                                                                                                            SyntaxFactory.Argument
                                                                                                            (
                                                                                                                SyntaxFactory.MemberAccessExpression
                                                                                                                (
                                                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                                                    SyntaxFactory.IdentifierName("r"),
                                                                                                                    SyntaxFactory.IdentifierName("Value")
                                                                                                                )
                                                                                                            ),
                                                                                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                                            SyntaxFactory.Argument
                                                                                                            (
                                                                                                                SyntaxFactory.IdentifierName("values")
                                                                                                            ),
                                                                                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                                            SyntaxFactory.Argument
                                                                                                            (
                                                                                                                SyntaxFactory.IdentifierName("xpath")
                                                                                                            )
                                                                                                        }
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    }
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.ExpressionStatement
                                                        (
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.IdentifierName("SaveInfoToFile")
                                                            )
                                                            .WithArgumentList
                                                            (
                                                                SyntaxFactory.ArgumentList
                                                                (
                                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                    (
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.IdentifierName("values_lists")
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.InvocationExpression
                                                (
                                                    SyntaxFactory.MemberAccessExpression
                                                    (
                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                        SyntaxFactory.IdentifierName("Console"),
                                                        SyntaxFactory.IdentifierName("WriteLine")
                                                    )
                                                )
                                                .WithArgumentList
                                                (
                                                    SyntaxFactory.ArgumentList
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                        (
                                                            SyntaxFactory.Argument
                                                            (
                                                                SyntaxFactory.LiteralExpression
                                                                (
                                                                    SyntaxKind.StringLiteralExpression,
                                                                    SyntaxFactory.Literal("Done")
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                    .WithElse
                                    (
                                        SyntaxFactory.ElseClause
                                        (
                                            SyntaxFactory.Block
                                            (
                                                SyntaxFactory.SingletonList<StatementSyntax>
                                                (
                                                    SyntaxFactory.ExpressionStatement
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.IdentifierName("Console"),
                                                                SyntaxFactory.IdentifierName("WriteLine")
                                                            )
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList
                                                            (
                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                (
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.StringLiteralExpression,
                                                                            SyntaxFactory.Literal("Settings file doesn't exist")
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("Console"),
                                                SyntaxFactory.IdentifierName("ReadKey")
                                            )
                                        )
                                    )
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.IdentifierName("HtmlDocument"),
                                SyntaxFactory.Identifier("DeleteThresh")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                    (
                                        SyntaxFactory.Parameter
                                        (
                                            SyntaxFactory.Identifier("doc")
                                        )
                                        .WithType
                                        (
                                            SyntaxFactory.IdentifierName("HtmlDocument")
                                        )
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.IdentifierName("var")
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("emptyScripts")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.InvocationExpression
                                                                (
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.InvocationExpression
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.IdentifierName("doc"),
                                                                                    SyntaxFactory.IdentifierName("DocumentNode")
                                                                                ),
                                                                                SyntaxFactory.IdentifierName("Descendants")
                                                                            )
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.ArgumentList
                                                                            (
                                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.LiteralExpression
                                                                                        (
                                                                                            SyntaxKind.StringLiteralExpression,
                                                                                            SyntaxFactory.Literal("script")
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        ),
                                                                        SyntaxFactory.IdentifierName("Select")
                                                                    )
                                                                )
                                                                .WithArgumentList
                                                                (
                                                                    SyntaxFactory.ArgumentList
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                        (
                                                                            SyntaxFactory.Argument
                                                                            (
                                                                                SyntaxFactory.SimpleLambdaExpression
                                                                                (
                                                                                    SyntaxFactory.Parameter
                                                                                    (
                                                                                        SyntaxFactory.Identifier("x")
                                                                                    ),
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.IdentifierName("x"),
                                                                                        SyntaxFactory.IdentifierName("XPath")
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                SyntaxFactory.IdentifierName("ToList")
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.IdentifierName("var")
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("emptyHead")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.InvocationExpression
                                                                (
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.InvocationExpression
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.IdentifierName("doc"),
                                                                                    SyntaxFactory.IdentifierName("DocumentNode")
                                                                                ),
                                                                                SyntaxFactory.IdentifierName("Descendants")
                                                                            )
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.ArgumentList
                                                                            (
                                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.LiteralExpression
                                                                                        (
                                                                                            SyntaxKind.StringLiteralExpression,
                                                                                            SyntaxFactory.Literal("head")
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        ),
                                                                        SyntaxFactory.IdentifierName("Select")
                                                                    )
                                                                )
                                                                .WithArgumentList
                                                                (
                                                                    SyntaxFactory.ArgumentList
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                        (
                                                                            SyntaxFactory.Argument
                                                                            (
                                                                                SyntaxFactory.SimpleLambdaExpression
                                                                                (
                                                                                    SyntaxFactory.Parameter
                                                                                    (
                                                                                        SyntaxFactory.Identifier("x")
                                                                                    ),
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.IdentifierName("x"),
                                                                                        SyntaxFactory.IdentifierName("XPath")
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                SyntaxFactory.IdentifierName("ToList")
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("emptyScripts"),
                                                SyntaxFactory.IdentifierName("ForEach")
                                            )
                                        )
                                        .WithArgumentList
                                        (
                                            SyntaxFactory.ArgumentList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                (
                                                    SyntaxFactory.Argument
                                                    (
                                                        SyntaxFactory.SimpleLambdaExpression
                                                        (
                                                            SyntaxFactory.Parameter
                                                            (
                                                                SyntaxFactory.Identifier("xpath")
                                                            ),
                                                            SyntaxFactory.Block
                                                            (
                                                                SyntaxFactory.LocalDeclarationStatement
                                                                (
                                                                    SyntaxFactory.VariableDeclaration
                                                                    (
                                                                        SyntaxFactory.IdentifierName("var")
                                                                    )
                                                                    .WithVariables
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                                        (
                                                                            SyntaxFactory.VariableDeclarator
                                                                            (
                                                                                SyntaxFactory.Identifier("node")
                                                                            )
                                                                            .WithInitializer
                                                                            (
                                                                                SyntaxFactory.EqualsValueClause
                                                                                (
                                                                                    SyntaxFactory.InvocationExpression
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.MemberAccessExpression
                                                                                            (
                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                SyntaxFactory.IdentifierName("doc"),
                                                                                                SyntaxFactory.IdentifierName("DocumentNode")
                                                                                            ),
                                                                                            SyntaxFactory.IdentifierName("SelectSingleNode")
                                                                                        )
                                                                                    )
                                                                                    .WithArgumentList
                                                                                    (
                                                                                        SyntaxFactory.ArgumentList
                                                                                        (
                                                                                            SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                            (
                                                                                                SyntaxFactory.Argument
                                                                                                (
                                                                                                    SyntaxFactory.IdentifierName("xpath")
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                SyntaxFactory.IfStatement
                                                                (
                                                                    SyntaxFactory.BinaryExpression
                                                                    (
                                                                        SyntaxKind.NotEqualsExpression,
                                                                        SyntaxFactory.IdentifierName("node"),
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.NullLiteralExpression
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.Block
                                                                    (
                                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                                        (
                                                                            SyntaxFactory.ExpressionStatement
                                                                            (
                                                                                SyntaxFactory.InvocationExpression
                                                                                (
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.IdentifierName("node"),
                                                                                        SyntaxFactory.IdentifierName("Remove")
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("emptyHead"),
                                                SyntaxFactory.IdentifierName("ForEach")
                                            )
                                        )
                                        .WithArgumentList
                                        (
                                            SyntaxFactory.ArgumentList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                (
                                                    SyntaxFactory.Argument
                                                    (
                                                        SyntaxFactory.SimpleLambdaExpression
                                                        (
                                                            SyntaxFactory.Parameter
                                                            (
                                                                SyntaxFactory.Identifier("xpath")
                                                            ),
                                                            SyntaxFactory.Block
                                                            (
                                                                SyntaxFactory.LocalDeclarationStatement
                                                                (
                                                                    SyntaxFactory.VariableDeclaration
                                                                    (
                                                                        SyntaxFactory.IdentifierName("var")
                                                                    )
                                                                    .WithVariables
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                                        (
                                                                            SyntaxFactory.VariableDeclarator
                                                                            (
                                                                                SyntaxFactory.Identifier("node")
                                                                            )
                                                                            .WithInitializer
                                                                            (
                                                                                SyntaxFactory.EqualsValueClause
                                                                                (
                                                                                    SyntaxFactory.InvocationExpression
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.MemberAccessExpression
                                                                                            (
                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                SyntaxFactory.IdentifierName("doc"),
                                                                                                SyntaxFactory.IdentifierName("DocumentNode")
                                                                                            ),
                                                                                            SyntaxFactory.IdentifierName("SelectSingleNode")
                                                                                        )
                                                                                    )
                                                                                    .WithArgumentList
                                                                                    (
                                                                                        SyntaxFactory.ArgumentList
                                                                                        (
                                                                                            SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                            (
                                                                                                SyntaxFactory.Argument
                                                                                                (
                                                                                                    SyntaxFactory.IdentifierName("xpath")
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                SyntaxFactory.IfStatement
                                                                (
                                                                    SyntaxFactory.BinaryExpression
                                                                    (
                                                                        SyntaxKind.NotEqualsExpression,
                                                                        SyntaxFactory.IdentifierName("node"),
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.NullLiteralExpression
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.Block
                                                                    (
                                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                                        (
                                                                            SyntaxFactory.ExpressionStatement
                                                                            (
                                                                                SyntaxFactory.InvocationExpression
                                                                                (
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.IdentifierName("node"),
                                                                                        SyntaxFactory.IdentifierName("Remove")
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ReturnStatement
                                    (
                                        SyntaxFactory.IdentifierName("doc")
                                    )
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.GenericName
                                (
                                    SyntaxFactory.Identifier("List")
                                )
                                .WithTypeArgumentList
                                (
                                    SyntaxFactory.TypeArgumentList
                                    (
                                        SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                            )
                                        )
                                    )
                                ),
                                SyntaxFactory.Identifier("GetValuesList")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SeparatedList<ParameterSyntax>
                                    (
                                        new SyntaxNodeOrToken[]
                                        {
                                            SyntaxFactory.Parameter
                                            (
                                                SyntaxFactory.Identifier("doc")
                                            )
                                            .WithType
                                            (
                                                SyntaxFactory.IdentifierName("HtmlDocument")
                                            ),
                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                            SyntaxFactory.Parameter
                                            (
                                                SyntaxFactory.Identifier("page_values")
                                            )
                                            .WithType
                                            (
                                                SyntaxFactory.PredefinedType
                                                (
                                                    SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                                )
                                            ),
                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                            SyntaxFactory.Parameter
                                            (
                                                SyntaxFactory.Identifier("xpath")
                                            )
                                            .WithType
                                            (
                                                SyntaxFactory.PredefinedType
                                                (
                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                )
                                            )
                                        }
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.GenericName
                                            (
                                                SyntaxFactory.Identifier("List")
                                            )
                                            .WithTypeArgumentList
                                            (
                                                SyntaxFactory.TypeArgumentList
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                    (
                                                        SyntaxFactory.PredefinedType
                                                        (
                                                            SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("values")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.ObjectCreationExpression
                                                        (
                                                            SyntaxFactory.GenericName
                                                            (
                                                                SyntaxFactory.Identifier("List")
                                                            )
                                                            .WithTypeArgumentList
                                                            (
                                                                SyntaxFactory.TypeArgumentList
                                                                (
                                                                    SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                    (
                                                                        SyntaxFactory.PredefinedType
                                                                        (
                                                                            SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList()
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("value_replace")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.StringLiteralExpression,
                                                            SyntaxFactory.Literal("")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("buff_xpath")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.StringLiteralExpression,
                                                            SyntaxFactory.Literal("")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ForStatement
                                    (
                                        SyntaxFactory.Block
                                        (
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("buff_xpath"),
                                                    SyntaxFactory.InvocationExpression
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.IdentifierName("String"),
                                                            SyntaxFactory.IdentifierName("Format")
                                                        )
                                                    )
                                                    .WithArgumentList
                                                    (
                                                        SyntaxFactory.ArgumentList
                                                        (
                                                            SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                            (
                                                                new SyntaxNodeOrToken[]
                                                                {
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.IdentifierName(@"@xpath")
                                                                    ),
                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.IdentifierName("i")
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.TryStatement
                                            (
                                                SyntaxFactory.SingletonList<CatchClauseSyntax>
                                                (
                                                    SyntaxFactory.CatchClause()
                                                    .WithDeclaration
                                                    (
                                                        SyntaxFactory.CatchDeclaration
                                                        (
                                                            SyntaxFactory.IdentifierName("ArgumentNullException")
                                                        )
                                                        .WithIdentifier
                                                        (
                                                            SyntaxFactory.Identifier("ex_null")
                                                        )
                                                    )
                                                    .WithBlock
                                                    (
                                                        SyntaxFactory.Block
                                                        (
                                                            SyntaxFactory.SingletonList<StatementSyntax>
                                                            (
                                                                SyntaxFactory.ExpressionStatement
                                                                (
                                                                    SyntaxFactory.AssignmentExpression
                                                                    (
                                                                        SyntaxKind.SimpleAssignmentExpression,
                                                                        SyntaxFactory.IdentifierName("value_replace"),
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.StringLiteralExpression,
                                                                            SyntaxFactory.Literal("")
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                            .WithBlock
                                            (
                                                SyntaxFactory.Block
                                                (
                                                    SyntaxFactory.SingletonList<StatementSyntax>
                                                    (
                                                        SyntaxFactory.ExpressionStatement
                                                        (
                                                            SyntaxFactory.AssignmentExpression
                                                            (
                                                                SyntaxKind.SimpleAssignmentExpression,
                                                                SyntaxFactory.IdentifierName("value_replace"),
                                                                SyntaxFactory.InvocationExpression
                                                                (
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.MemberAccessExpression
                                                                        (
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            SyntaxFactory.InvocationExpression
                                                                            (
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.InvocationExpression
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.MemberAccessExpression
                                                                                            (
                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                SyntaxFactory.IdentifierName("doc"),
                                                                                                SyntaxFactory.IdentifierName("DocumentNode")
                                                                                            ),
                                                                                            SyntaxFactory.IdentifierName("SelectNodes")
                                                                                        )
                                                                                    )
                                                                                    .WithArgumentList
                                                                                    (
                                                                                        SyntaxFactory.ArgumentList
                                                                                        (
                                                                                            SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                            (
                                                                                                SyntaxFactory.Argument
                                                                                                (
                                                                                                    SyntaxFactory.IdentifierName("buff_xpath")
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    ),
                                                                                    SyntaxFactory.IdentifierName("First")
                                                                                )
                                                                            ),
                                                                            SyntaxFactory.IdentifierName("InnerText")
                                                                        ),
                                                                        SyntaxFactory.IdentifierName("ToString")
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("value_replace"),
                                                    SyntaxFactory.InvocationExpression
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.IdentifierName("value_replace"),
                                                            SyntaxFactory.IdentifierName("Replace")
                                                        )
                                                    )
                                                    .WithArgumentList
                                                    (
                                                        SyntaxFactory.ArgumentList
                                                        (
                                                            SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                            (
                                                                new SyntaxNodeOrToken[]
                                                                {
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.StringLiteralExpression,
                                                                            SyntaxFactory.Literal("	")
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.StringLiteralExpression,
                                                                            SyntaxFactory.Literal("")
                                                                        )
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("value_replace"),
                                                    SyntaxFactory.InvocationExpression
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.IdentifierName("value_replace"),
                                                            SyntaxFactory.IdentifierName("Replace")
                                                        )
                                                    )
                                                    .WithArgumentList
                                                    (
                                                        SyntaxFactory.ArgumentList
                                                        (
                                                            SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                            (
                                                                new SyntaxNodeOrToken[]
                                                                {
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.StringLiteralExpression,
                                                                            SyntaxFactory.Literal("\n")
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.LiteralExpression
                                                                        (
                                                                            SyntaxKind.StringLiteralExpression,
                                                                            SyntaxFactory.Literal("")
                                                                        )
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.InvocationExpression
                                                (
                                                    SyntaxFactory.MemberAccessExpression
                                                    (
                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                        SyntaxFactory.IdentifierName("values"),
                                                        SyntaxFactory.IdentifierName("Add")
                                                    )
                                                )
                                                .WithArgumentList
                                                (
                                                    SyntaxFactory.ArgumentList
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                        (
                                                            SyntaxFactory.Argument
                                                            (
                                                                SyntaxFactory.IdentifierName("value_replace")
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                    .WithDeclaration
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("i")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.NumericLiteralExpression,
                                                            SyntaxFactory.Literal(1)
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                    .WithCondition
                                    (
                                        SyntaxFactory.BinaryExpression
                                        (
                                            SyntaxKind.LessThanOrEqualExpression,
                                            SyntaxFactory.IdentifierName("i"),
                                            SyntaxFactory.IdentifierName("page_values")
                                        )
                                    )
                                    .WithIncrementors
                                    (
                                        SyntaxFactory.SingletonSeparatedList<ExpressionSyntax>
                                        (
                                            SyntaxFactory.PostfixUnaryExpression
                                            (
                                                SyntaxKind.PostIncrementExpression,
                                                SyntaxFactory.IdentifierName("i")
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ReturnStatement
                                    (
                                        SyntaxFactory.IdentifierName("values")
                                    )
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.PredefinedType
                                (
                                    SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                ),
                                SyntaxFactory.Identifier("LoadDoc")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                    (
                                        SyntaxFactory.Parameter
                                        (
                                            SyntaxFactory.Identifier("_html")
                                        )
                                        .WithType
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.ObjectKeyword)
                                            )
                                        )
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.IdentifierName("HtmlDocument")
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("doc")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.ObjectCreationExpression
                                                        (
                                                            SyntaxFactory.IdentifierName("HtmlDocument")
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList()
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.IdentifierName("HtmlWeb")
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("hw")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.ObjectCreationExpression
                                                        (
                                                            SyntaxFactory.IdentifierName("HtmlWeb")
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList()
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.AssignmentExpression
                                        (
                                            SyntaxKind.SimpleAssignmentExpression,
                                            SyntaxFactory.IdentifierName("doc"),
                                            SyntaxFactory.InvocationExpression
                                            (
                                                SyntaxFactory.MemberAccessExpression
                                                (
                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                    SyntaxFactory.IdentifierName("hw"),
                                                    SyntaxFactory.IdentifierName("Load")
                                                )
                                            )
                                            .WithArgumentList
                                            (
                                                SyntaxFactory.ArgumentList
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                    (
                                                        SyntaxFactory.Argument
                                                        (
                                                            SyntaxFactory.CastExpression
                                                            (
                                                                SyntaxFactory.PredefinedType
                                                                (
                                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                ),
                                                                SyntaxFactory.IdentifierName("_html")
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.AssignmentExpression
                                        (
                                            SyntaxKind.SimpleAssignmentExpression,
                                            SyntaxFactory.IdentifierName("doc"),
                                            SyntaxFactory.InvocationExpression
                                            (
                                                SyntaxFactory.IdentifierName("DeleteThresh")
                                            )
                                            .WithArgumentList
                                            (
                                                SyntaxFactory.ArgumentList
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                    (
                                                        SyntaxFactory.Argument
                                                        (
                                                            SyntaxFactory.IdentifierName("doc")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("Console"),
                                                SyntaxFactory.IdentifierName("WriteLine")
                                            )
                                        )
                                        .WithArgumentList
                                        (
                                            SyntaxFactory.ArgumentList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                (
                                                    SyntaxFactory.Argument
                                                    (
                                                        SyntaxFactory.BinaryExpression
                                                        (
                                                            SyntaxKind.AddExpression,
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.MemberAccessExpression
                                                                        (
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            SyntaxFactory.IdentifierName("Thread"),
                                                                            SyntaxFactory.IdentifierName("CurrentThread")
                                                                        ),
                                                                        SyntaxFactory.IdentifierName("Name")
                                                                    ),
                                                                    SyntaxFactory.IdentifierName("ToString")
                                                                )
                                                            ),
                                                            SyntaxFactory.LiteralExpression
                                                            (
                                                                SyntaxKind.StringLiteralExpression,
                                                                SyntaxFactory.Literal("....Done.....")
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("doc_html_Dic"),
                                                SyntaxFactory.IdentifierName("Add")
                                            )
                                        )
                                        .WithArgumentList
                                        (
                                            SyntaxFactory.ArgumentList
                                            (
                                                SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                (
                                                    new SyntaxNodeOrToken[]
                                                    {
                                                        SyntaxFactory.Argument
                                                        (
                                                            SyntaxFactory.InvocationExpression
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.MemberAccessExpression
                                                                        (
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            SyntaxFactory.IdentifierName("Thread"),
                                                                            SyntaxFactory.IdentifierName("CurrentThread")
                                                                        ),
                                                                        SyntaxFactory.IdentifierName("Name")
                                                                    ),
                                                                    SyntaxFactory.IdentifierName("ToString")
                                                                )
                                                            )
                                                        ),
                                                        SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                        SyntaxFactory.Argument
                                                        (
                                                            SyntaxFactory.IdentifierName("doc")
                                                        )
                                                    }
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.ExpressionStatement
                                    (
                                        SyntaxFactory.InvocationExpression
                                        (
                                            SyntaxFactory.MemberAccessExpression
                                            (
                                                SyntaxKind.SimpleMemberAccessExpression,
                                                SyntaxFactory.IdentifierName("doc"),
                                                SyntaxFactory.IdentifierName("Save")
                                            )
                                        )
                                        .WithArgumentList
                                        (
                                            SyntaxFactory.ArgumentList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                (
                                                    SyntaxFactory.Argument
                                                    (
                                                        SyntaxFactory.InvocationExpression
                                                        (
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.IdentifierName("String"),
                                                                SyntaxFactory.IdentifierName("Format")
                                                            )
                                                        )
                                                        .WithArgumentList
                                                        (
                                                            SyntaxFactory.ArgumentList
                                                            (
                                                                SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                (
                                                                    new SyntaxNodeOrToken[]
                                                                    {
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.BinaryExpression
                                                                            (
                                                                                SyntaxKind.AddExpression,
                                                                                SyntaxFactory.InvocationExpression
                                                                                (
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.IdentifierName("Directory"),
                                                                                        SyntaxFactory.IdentifierName("GetCurrentDirectory")
                                                                                    )
                                                                                ),
                                                                                SyntaxFactory.LiteralExpression
                                                                                (
                                                                                    SyntaxKind.StringLiteralExpression,
                                                                                    SyntaxFactory.Literal
                                                                                    (
                                                                                        "@\"\\Temp\\{0}.html\"",
                                                                                        "\\Temp\\{0}.html"
                                                                                    )
                                                                                )
                                                                            )
                                                                        ),
                                                                        SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                        SyntaxFactory.Argument
                                                                        (
                                                                            SyntaxFactory.InvocationExpression
                                                                            (
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.MemberAccessExpression
                                                                                    (
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.IdentifierName("Thread"),
                                                                                            SyntaxFactory.IdentifierName("CurrentThread")
                                                                                        ),
                                                                                        SyntaxFactory.IdentifierName("Name")
                                                                                    ),
                                                                                    SyntaxFactory.IdentifierName("ToString")
                                                                                )
                                                                            )
                                                                        )
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.PredefinedType
                                (
                                    SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                ),
                                SyntaxFactory.Identifier("ThreadLoadDocs")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                    (
                                        SyntaxFactory.Parameter
                                        (
                                            SyntaxFactory.Identifier("_page_number")
                                        )
                                        .WithType
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                            )
                                        )
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("threads_number_before")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.InvocationExpression
                                                                (
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.IdentifierName("Process"),
                                                                        SyntaxFactory.IdentifierName("GetCurrentProcess")
                                                                    )
                                                                ),
                                                                SyntaxFactory.IdentifierName("Threads")
                                                            ),
                                                            SyntaxFactory.IdentifierName("Count")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("threads_number_after")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.MemberAccessExpression
                                                            (
                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                SyntaxFactory.InvocationExpression
                                                                (
                                                                    SyntaxFactory.MemberAccessExpression
                                                                    (
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        SyntaxFactory.IdentifierName("Process"),
                                                                        SyntaxFactory.IdentifierName("GetCurrentProcess")
                                                                    )
                                                                ),
                                                                SyntaxFactory.IdentifierName("Threads")
                                                            ),
                                                            SyntaxFactory.IdentifierName("Count")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("current_page")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.NumericLiteralExpression,
                                                            SyntaxFactory.Literal(2)
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.PredefinedType
                                            (
                                                SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("i")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.NumericLiteralExpression,
                                                            SyntaxFactory.Literal(1)
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.LocalDeclarationStatement
                                    (
                                        SyntaxFactory.VariableDeclaration
                                        (
                                            SyntaxFactory.ArrayType
                                            (
                                                SyntaxFactory.IdentifierName("HtmlDocument")
                                            )
                                            .WithRankSpecifiers
                                            (
                                                SyntaxFactory.SingletonList<ArrayRankSpecifierSyntax>
                                                (
                                                    SyntaxFactory.ArrayRankSpecifier
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<ExpressionSyntax>
                                                        (
                                                            SyntaxFactory.OmittedArraySizeExpression()
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                        .WithVariables
                                        (
                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                            (
                                                SyntaxFactory.VariableDeclarator
                                                (
                                                    SyntaxFactory.Identifier("doc_array")
                                                )
                                                .WithInitializer
                                                (
                                                    SyntaxFactory.EqualsValueClause
                                                    (
                                                        SyntaxFactory.ArrayCreationExpression
                                                        (
                                                            SyntaxFactory.ArrayType
                                                            (
                                                                SyntaxFactory.IdentifierName("HtmlDocument")
                                                            )
                                                            .WithRankSpecifiers
                                                            (
                                                                SyntaxFactory.SingletonList<ArrayRankSpecifierSyntax>
                                                                (
                                                                    SyntaxFactory.ArrayRankSpecifier
                                                                    (
                                                                        SyntaxFactory.SingletonSeparatedList<ExpressionSyntax>
                                                                        (
                                                                            SyntaxFactory.IdentifierName("_page_number")
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    SyntaxFactory.WhileStatement
                                    (
                                        SyntaxFactory.LiteralExpression
                                        (
                                            SyntaxKind.TrueLiteralExpression
                                        ),
                                        SyntaxFactory.Block
                                        (
                                            SyntaxFactory.SingletonList<StatementSyntax>
                                            (
                                                SyntaxFactory.IfStatement
                                                (
                                                    SyntaxFactory.BinaryExpression
                                                    (
                                                        SyntaxKind.LessThanOrEqualExpression,
                                                        SyntaxFactory.ParenthesizedExpression
                                                        (
                                                            SyntaxFactory.BinaryExpression
                                                            (
                                                                SyntaxKind.SubtractExpression,
                                                                SyntaxFactory.IdentifierName("threads_number_after"),
                                                                SyntaxFactory.IdentifierName("threads_number_before")
                                                            )
                                                        ),
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.NumericLiteralExpression,
                                                            SyntaxFactory.Literal(4)
                                                        )
                                                    ),
                                                    SyntaxFactory.Block
                                                    (
                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                        (
                                                            SyntaxFactory.IfStatement
                                                            (
                                                                SyntaxFactory.BinaryExpression
                                                                (
                                                                    SyntaxKind.LessThanOrEqualExpression,
                                                                    SyntaxFactory.IdentifierName("current_page"),
                                                                    SyntaxFactory.IdentifierName("_page_number")
                                                                ),
                                                                SyntaxFactory.Block
                                                                (
                                                                    SyntaxFactory.LocalDeclarationStatement
                                                                    (
                                                                        SyntaxFactory.VariableDeclaration
                                                                        (
                                                                            SyntaxFactory.PredefinedType
                                                                            (
                                                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                            )
                                                                        )
                                                                        .WithVariables
                                                                        (
                                                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                                            (
                                                                                SyntaxFactory.VariableDeclarator
                                                                                (
                                                                                    SyntaxFactory.Identifier("html")
                                                                                )
                                                                                .WithInitializer
                                                                                (
                                                                                    SyntaxFactory.EqualsValueClause
                                                                                    (
                                                                                        SyntaxFactory.InvocationExpression
                                                                                        (
                                                                                            SyntaxFactory.MemberAccessExpression
                                                                                            (
                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                SyntaxFactory.ElementAccessExpression
                                                                                                (
                                                                                                    SyntaxFactory.IdentifierName("html_adress_list")
                                                                                                )
                                                                                                .WithArgumentList
                                                                                                (
                                                                                                    SyntaxFactory.BracketedArgumentList
                                                                                                    (
                                                                                                        SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                                        (
                                                                                                            SyntaxFactory.Argument
                                                                                                            (
                                                                                                                SyntaxFactory.IdentifierName("i")
                                                                                                            )
                                                                                                        )
                                                                                                    )
                                                                                                ),
                                                                                                SyntaxFactory.IdentifierName("ToString")
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.LocalDeclarationStatement
                                                                    (
                                                                        SyntaxFactory.VariableDeclaration
                                                                        (
                                                                            SyntaxFactory.IdentifierName("Thread")
                                                                        )
                                                                        .WithVariables
                                                                        (
                                                                            SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                                            (
                                                                                SyntaxFactory.VariableDeclarator
                                                                                (
                                                                                    SyntaxFactory.Identifier("thread_doc")
                                                                                )
                                                                                .WithInitializer
                                                                                (
                                                                                    SyntaxFactory.EqualsValueClause
                                                                                    (
                                                                                        SyntaxFactory.ObjectCreationExpression
                                                                                        (
                                                                                            SyntaxFactory.IdentifierName("Thread")
                                                                                        )
                                                                                        .WithArgumentList
                                                                                        (
                                                                                            SyntaxFactory.ArgumentList
                                                                                            (
                                                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                                (
                                                                                                    SyntaxFactory.Argument
                                                                                                    (
                                                                                                        SyntaxFactory.IdentifierName("LoadDoc")
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.AssignmentExpression
                                                                        (
                                                                            SyntaxKind.SimpleAssignmentExpression,
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.IdentifierName("thread_doc"),
                                                                                SyntaxFactory.IdentifierName("Name")
                                                                            ),
                                                                            SyntaxFactory.InvocationExpression
                                                                            (
                                                                                SyntaxFactory.MemberAccessExpression
                                                                                (
                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                    SyntaxFactory.IdentifierName("String"),
                                                                                    SyntaxFactory.IdentifierName("Format")
                                                                                )
                                                                            )
                                                                            .WithArgumentList
                                                                            (
                                                                                SyntaxFactory.ArgumentList
                                                                                (
                                                                                    SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                                    (
                                                                                        new SyntaxNodeOrToken[]
                                                                                        {
                                                                                            SyntaxFactory.Argument
                                                                                            (
                                                                                                SyntaxFactory.LiteralExpression
                                                                                                (
                                                                                                    SyntaxKind.StringLiteralExpression,
                                                                                                    SyntaxFactory.Literal("page_{0}")
                                                                                                )
                                                                                            ),
                                                                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                            SyntaxFactory.Argument
                                                                                            (
                                                                                                SyntaxFactory.IdentifierName("i")
                                                                                            )
                                                                                        }
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.InvocationExpression
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.IdentifierName("th_list"),
                                                                                SyntaxFactory.IdentifierName("Add")
                                                                            )
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.ArgumentList
                                                                            (
                                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.IdentifierName("thread_doc")
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.InvocationExpression
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.IdentifierName("thread_doc"),
                                                                                SyntaxFactory.IdentifierName("Start")
                                                                            )
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.ArgumentList
                                                                            (
                                                                                SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.IdentifierName("html")
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.PostfixUnaryExpression
                                                                        (
                                                                            SyntaxKind.PostIncrementExpression,
                                                                            SyntaxFactory.IdentifierName("i")
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.PostfixUnaryExpression
                                                                        (
                                                                            SyntaxKind.PostIncrementExpression,
                                                                            SyntaxFactory.IdentifierName("current_page")
                                                                        )
                                                                    ),
                                                                    SyntaxFactory.ExpressionStatement
                                                                    (
                                                                        SyntaxFactory.InvocationExpression
                                                                        (
                                                                            SyntaxFactory.MemberAccessExpression
                                                                            (
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                SyntaxFactory.IdentifierName("Console"),
                                                                                SyntaxFactory.IdentifierName("WriteLine")
                                                                            )
                                                                        )
                                                                        .WithArgumentList
                                                                        (
                                                                            SyntaxFactory.ArgumentList
                                                                            (
                                                                                SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                                (
                                                                                    new SyntaxNodeOrToken[]
                                                                                    {
                                                                                        SyntaxFactory.Argument
                                                                                        (
                                                                                            SyntaxFactory.LiteralExpression
                                                                                            (
                                                                                                SyntaxKind.StringLiteralExpression,
                                                                                                SyntaxFactory.Literal("Threads = {0}")
                                                                                            )
                                                                                        ),
                                                                                        SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                        SyntaxFactory.Argument
                                                                                        (
                                                                                            SyntaxFactory.MemberAccessExpression
                                                                                            (
                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                SyntaxFactory.MemberAccessExpression
                                                                                                (
                                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                                    SyntaxFactory.InvocationExpression
                                                                                                    (
                                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                                        (
                                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                                            SyntaxFactory.IdentifierName("Process"),
                                                                                                            SyntaxFactory.IdentifierName("GetCurrentProcess")
                                                                                                        )
                                                                                                    ),
                                                                                                    SyntaxFactory.IdentifierName("Threads")
                                                                                                ),
                                                                                                SyntaxFactory.IdentifierName("Count")
                                                                                            )
                                                                                        )
                                                                                    }
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                            .WithElse
                                                            (
                                                                SyntaxFactory.ElseClause
                                                                (
                                                                    SyntaxFactory.Block
                                                                    (
                                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                                        (
                                                                            SyntaxFactory.BreakStatement()
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.PredefinedType
                                (
                                    SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                ),
                                SyntaxFactory.Identifier("SaveInfoToFile")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                    (
                                        SyntaxFactory.Parameter
                                        (
                                            SyntaxFactory.Identifier("list")
                                        )
                                        .WithType
                                        (
                                            SyntaxFactory.GenericName
                                            (
                                                SyntaxFactory.Identifier("Dictionary")
                                            )
                                            .WithTypeArgumentList
                                            (
                                                SyntaxFactory.TypeArgumentList
                                                (
                                                    SyntaxFactory.SeparatedList<TypeSyntax>
                                                    (
                                                        new SyntaxNodeOrToken[]
                                                        {
                                                            SyntaxFactory.PredefinedType
                                                            (
                                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                            ),
                                                            SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                            SyntaxFactory.GenericName
                                                            (
                                                                SyntaxFactory.Identifier("List")
                                                            )
                                                            .WithTypeArgumentList
                                                            (
                                                                SyntaxFactory.TypeArgumentList
                                                                (
                                                                    SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                    (
                                                                        SyntaxFactory.PredefinedType
                                                                        (
                                                                            SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        }
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.SingletonList<StatementSyntax>
                                    (
                                        SyntaxFactory.ForEachStatement
                                        (
                                            SyntaxFactory.IdentifierName("var"),
                                            SyntaxFactory.Identifier("r"),
                                            SyntaxFactory.IdentifierName("list"),
                                            SyntaxFactory.Block
                                            (
                                                SyntaxFactory.LocalDeclarationStatement
                                                (
                                                    SyntaxFactory.VariableDeclaration
                                                    (
                                                        SyntaxFactory.IdentifierName("XmlSerializer")
                                                    )
                                                    .WithVariables
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                        (
                                                            SyntaxFactory.VariableDeclarator
                                                            (
                                                                SyntaxFactory.Identifier("ser")
                                                            )
                                                            .WithInitializer
                                                            (
                                                                SyntaxFactory.EqualsValueClause
                                                                (
                                                                    SyntaxFactory.ObjectCreationExpression
                                                                    (
                                                                        SyntaxFactory.IdentifierName("XmlSerializer")
                                                                    )
                                                                    .WithArgumentList
                                                                    (
                                                                        SyntaxFactory.ArgumentList
                                                                        (
                                                                            SyntaxFactory.SingletonSeparatedList<ArgumentSyntax>
                                                                            (
                                                                                SyntaxFactory.Argument
                                                                                (
                                                                                    SyntaxFactory.TypeOfExpression
                                                                                    (
                                                                                        SyntaxFactory.GenericName
                                                                                        (
                                                                                            SyntaxFactory.Identifier("List")
                                                                                        )
                                                                                        .WithTypeArgumentList
                                                                                        (
                                                                                            SyntaxFactory.TypeArgumentList
                                                                                            (
                                                                                                SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                                                                (
                                                                                                    SyntaxFactory.PredefinedType
                                                                                                    (
                                                                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.LocalDeclarationStatement
                                                (
                                                    SyntaxFactory.VariableDeclaration
                                                    (
                                                        SyntaxFactory.PredefinedType
                                                        (
                                                            SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                        )
                                                    )
                                                    .WithVariables
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                        (
                                                            SyntaxFactory.VariableDeclarator
                                                            (
                                                                SyntaxFactory.Identifier("path")
                                                            )
                                                            .WithInitializer
                                                            (
                                                                SyntaxFactory.EqualsValueClause
                                                                (
                                                                    SyntaxFactory.InvocationExpression
                                                                    (
                                                                        SyntaxFactory.MemberAccessExpression
                                                                        (
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            SyntaxFactory.IdentifierName("String"),
                                                                            SyntaxFactory.IdentifierName("Format")
                                                                        )
                                                                    )
                                                                    .WithArgumentList
                                                                    (
                                                                        SyntaxFactory.ArgumentList
                                                                        (
                                                                            SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                            (
                                                                                new SyntaxNodeOrToken[]
                                                                                {
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.BinaryExpression
                                                                                        (
                                                                                            SyntaxKind.AddExpression,
                                                                                            SyntaxFactory.InvocationExpression
                                                                                            (
                                                                                                SyntaxFactory.MemberAccessExpression
                                                                                                (
                                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                                    SyntaxFactory.IdentifierName("Directory"),
                                                                                                    SyntaxFactory.IdentifierName("GetCurrentDirectory")
                                                                                                )
                                                                                            ),
                                                                                            SyntaxFactory.LiteralExpression
                                                                                            (
                                                                                                SyntaxKind.StringLiteralExpression,
                                                                                                SyntaxFactory.Literal
                                                                                                (
                                                                                                    "@\"\\Temp\\{0}.xml\"",
                                                                                                    "\\Temp\\{0}.xml"
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    ),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.IdentifierName("r"),
                                                                                            SyntaxFactory.IdentifierName("Key")
                                                                                        )
                                                                                    )
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.LocalDeclarationStatement
                                                (
                                                    SyntaxFactory.VariableDeclaration
                                                    (
                                                        SyntaxFactory.IdentifierName("FileStream")
                                                    )
                                                    .WithVariables
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                        (
                                                            SyntaxFactory.VariableDeclarator
                                                            (
                                                                SyntaxFactory.Identifier("file")
                                                            )
                                                            .WithInitializer
                                                            (
                                                                SyntaxFactory.EqualsValueClause
                                                                (
                                                                    SyntaxFactory.ObjectCreationExpression
                                                                    (
                                                                        SyntaxFactory.IdentifierName("FileStream")
                                                                    )
                                                                    .WithArgumentList
                                                                    (
                                                                        SyntaxFactory.ArgumentList
                                                                        (
                                                                            SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                                            (
                                                                                new SyntaxNodeOrToken[]
                                                                                {
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.IdentifierName("path")
                                                                                    ),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.IdentifierName("FileMode"),
                                                                                            SyntaxFactory.IdentifierName("Create")
                                                                                        )
                                                                                    ),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.IdentifierName("FileAccess"),
                                                                                            SyntaxFactory.IdentifierName("Write")
                                                                                        )
                                                                                    ),
                                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                                    SyntaxFactory.Argument
                                                                                    (
                                                                                        SyntaxFactory.MemberAccessExpression
                                                                                        (
                                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                                            SyntaxFactory.IdentifierName("FileShare"),
                                                                                            SyntaxFactory.IdentifierName("None")
                                                                                        )
                                                                                    )
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.ExpressionStatement
                                                (
                                                    SyntaxFactory.InvocationExpression
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.IdentifierName("ser"),
                                                            SyntaxFactory.IdentifierName("Serialize")
                                                        )
                                                    )
                                                    .WithArgumentList
                                                    (
                                                        SyntaxFactory.ArgumentList
                                                        (
                                                            SyntaxFactory.SeparatedList<ArgumentSyntax>
                                                            (
                                                                new SyntaxNodeOrToken[]
                                                                {
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.IdentifierName("file")
                                                                    ),
                                                                    SyntaxFactory.Token(SyntaxKind.CommaToken),
                                                                    SyntaxFactory.Argument
                                                                    (
                                                                        SyntaxFactory.MemberAccessExpression
                                                                        (
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            SyntaxFactory.IdentifierName("r"),
                                                                            SyntaxFactory.IdentifierName("Value")
                                                                        )
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.ExpressionStatement
                                                (
                                                    SyntaxFactory.InvocationExpression
                                                    (
                                                        SyntaxFactory.MemberAccessExpression
                                                        (
                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                            SyntaxFactory.IdentifierName("file"),
                                                            SyntaxFactory.IdentifierName("Close")
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            ),
                            SyntaxFactory.MethodDeclaration
                            (
                                SyntaxFactory.PredefinedType
                                (
                                    SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                ),
                                SyntaxFactory.Identifier("Wait")
                            )
                            .WithModifiers
                            (
                                SyntaxFactory.TokenList
                                (
                                    new []
                                    {
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword),
                                        SyntaxFactory.Token(SyntaxKind.StaticKeyword)
                                    }
                                )
                            )
                            .WithParameterList
                            (
                                SyntaxFactory.ParameterList
                                (
                                    SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                    (
                                        SyntaxFactory.Parameter
                                        (
                                            SyntaxFactory.Identifier("thread_list")
                                        )
                                        .WithType
                                        (
                                            SyntaxFactory.GenericName
                                            (
                                                SyntaxFactory.Identifier("List")
                                            )
                                            .WithTypeArgumentList
                                            (
                                                SyntaxFactory.TypeArgumentList
                                                (
                                                    SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                    (
                                                        SyntaxFactory.IdentifierName("Thread")
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                            .WithBody
                            (
                                SyntaxFactory.Block
                                (
                                    SyntaxFactory.SingletonList<StatementSyntax>
                                    (
                                        SyntaxFactory.WhileStatement
                                        (
                                            SyntaxFactory.LiteralExpression
                                            (
                                                SyntaxKind.TrueLiteralExpression
                                            ),
                                            SyntaxFactory.Block
                                            (
                                                SyntaxFactory.LocalDeclarationStatement
                                                (
                                                    SyntaxFactory.VariableDeclaration
                                                    (
                                                        SyntaxFactory.PredefinedType
                                                        (
                                                            SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                                        )
                                                    )
                                                    .WithVariables
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                                        (
                                                            SyntaxFactory.VariableDeclarator
                                                            (
                                                                SyntaxFactory.Identifier("work_count")
                                                            )
                                                            .WithInitializer
                                                            (
                                                                SyntaxFactory.EqualsValueClause
                                                                (
                                                                    SyntaxFactory.LiteralExpression
                                                                    (
                                                                        SyntaxKind.NumericLiteralExpression,
                                                                        SyntaxFactory.Literal(0)
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.ForEachStatement
                                                (
                                                    SyntaxFactory.IdentifierName("var"),
                                                    SyntaxFactory.Identifier("th"),
                                                    SyntaxFactory.IdentifierName("thread_list"),
                                                    SyntaxFactory.Block
                                                    (
                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                        (
                                                            SyntaxFactory.IfStatement
                                                            (
                                                                SyntaxFactory.MemberAccessExpression
                                                                (
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    SyntaxFactory.IdentifierName("th"),
                                                                    SyntaxFactory.IdentifierName("IsAlive")
                                                                ),
                                                                SyntaxFactory.Block
                                                                (
                                                                    SyntaxFactory.SingletonList<StatementSyntax>
                                                                    (
                                                                        SyntaxFactory.ExpressionStatement
                                                                        (
                                                                            SyntaxFactory.PostfixUnaryExpression
                                                                            (
                                                                                SyntaxKind.PostIncrementExpression,
                                                                                SyntaxFactory.IdentifierName("work_count")
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                SyntaxFactory.IfStatement
                                                (
                                                    SyntaxFactory.BinaryExpression
                                                    (
                                                        SyntaxKind.EqualsExpression,
                                                        SyntaxFactory.IdentifierName("work_count"),
                                                        SyntaxFactory.LiteralExpression
                                                        (
                                                            SyntaxKind.NumericLiteralExpression,
                                                            SyntaxFactory.Literal(0)
                                                        )
                                                    ),
                                                    SyntaxFactory.Block
                                                    (
                                                        SyntaxFactory.SingletonList<StatementSyntax>
                                                        (
                                                            SyntaxFactory.BreakStatement()
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        }
                    )
                ),
                SyntaxFactory.ClassDeclaration("Settings")
                    .WithAttributeLists
                    (
                        SyntaxFactory.SingletonList<AttributeListSyntax>
                        (
                            SyntaxFactory.AttributeList
                            (
                                SyntaxFactory.SingletonSeparatedList<AttributeSyntax>
                                (
                                    SyntaxFactory.Attribute
                                    (
                                        SyntaxFactory.IdentifierName("Serializable")
                                    )
                                )
                            )
                        )
                    )
                    .WithModifiers
                    (
                        SyntaxFactory.TokenList
                        (
                            SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                        )
                    )
                    .WithMembers
                    (
                        SyntaxFactory.List<MemberDeclarationSyntax>
                        (
                            new MemberDeclarationSyntax[]
                            {
                                SyntaxFactory.FieldDeclaration
                                (
                                    SyntaxFactory.VariableDeclaration
                                    (
                                        SyntaxFactory.PredefinedType
                                        (
                                            SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                        )
                                    )
                                    .WithVariables
                                    (
                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                        (
                                            SyntaxFactory.VariableDeclarator
                                            (
                                                SyntaxFactory.Identifier("values")
                                            )
                                        )
                                    )
                                )
                                .WithModifiers
                                (
                                    SyntaxFactory.TokenList
                                    (
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                                    )
                                ),
                                SyntaxFactory.FieldDeclaration
                                (
                                    SyntaxFactory.VariableDeclaration
                                    (
                                        SyntaxFactory.PredefinedType
                                        (
                                            SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                        )
                                    )
                                    .WithVariables
                                    (
                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                        (
                                            SyntaxFactory.VariableDeclarator
                                            (
                                                SyntaxFactory.Identifier("xpath")
                                            )
                                        )
                                    )
                                )
                                .WithModifiers
                                (
                                    SyntaxFactory.TokenList
                                    (
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                                    )
                                ),
                                SyntaxFactory.FieldDeclaration
                                (
                                    SyntaxFactory.VariableDeclaration
                                    (
                                        SyntaxFactory.GenericName
                                        (
                                            SyntaxFactory.Identifier("List")
                                        )
                                        .WithTypeArgumentList
                                        (
                                            SyntaxFactory.TypeArgumentList
                                            (
                                                SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                (
                                                    SyntaxFactory.PredefinedType
                                                    (
                                                        SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                    )
                                                )
                                            )
                                        )
                                    )
                                    .WithVariables
                                    (
                                        SyntaxFactory.SingletonSeparatedList<VariableDeclaratorSyntax>
                                        (
                                            SyntaxFactory.VariableDeclarator
                                            (
                                                SyntaxFactory.Identifier("HTML")
                                            )
                                        )
                                    )
                                )
                                .WithModifiers
                                (
                                    SyntaxFactory.TokenList
                                    (
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                                    )
                                ),
                                SyntaxFactory.MethodDeclaration
                                (
                                    SyntaxFactory.PredefinedType
                                    (
                                        SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                    ),
                                    SyntaxFactory.Identifier("SetValues")
                                )
                                .WithModifiers
                                (
                                    SyntaxFactory.TokenList
                                    (
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                                    )
                                )
                                .WithParameterList
                                (
                                    SyntaxFactory.ParameterList
                                    (
                                        SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                        (
                                            SyntaxFactory.Parameter
                                            (
                                                SyntaxFactory.Identifier("_values")
                                            )
                                            .WithType
                                            (
                                                SyntaxFactory.PredefinedType
                                                (
                                                    SyntaxFactory.Token(SyntaxKind.IntKeyword)
                                                )
                                            )
                                        )
                                    )
                                )
                                .WithBody
                                (
                                    SyntaxFactory.Block
                                    (
                                        SyntaxFactory.SingletonList<StatementSyntax>
                                        (
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("values"),
                                                    SyntaxFactory.IdentifierName("_values")
                                                )
                                            )
                                        )
                                    )
                                ),
                                SyntaxFactory.MethodDeclaration
                                (
                                    SyntaxFactory.PredefinedType
                                    (
                                        SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                    ),
                                    SyntaxFactory.Identifier("SetXpath")
                                )
                                .WithModifiers
                                (
                                    SyntaxFactory.TokenList
                                    (
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                                    )
                                )
                                .WithParameterList
                                (
                                    SyntaxFactory.ParameterList
                                    (
                                        SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                        (
                                            SyntaxFactory.Parameter
                                            (
                                                SyntaxFactory.Identifier("_xpath")
                                            )
                                            .WithType
                                            (
                                                SyntaxFactory.PredefinedType
                                                (
                                                    SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                )
                                            )
                                        )
                                    )
                                )
                                .WithBody
                                (
                                    SyntaxFactory.Block
                                    (
                                        SyntaxFactory.SingletonList<StatementSyntax>
                                        (
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("xpath"),
                                                    SyntaxFactory.IdentifierName("_xpath")
                                                )
                                            )
                                        )
                                    )
                                ),
                                SyntaxFactory.MethodDeclaration
                                (
                                    SyntaxFactory.PredefinedType
                                    (
                                        SyntaxFactory.Token(SyntaxKind.VoidKeyword)
                                    ),
                                    SyntaxFactory.Identifier("SetHTML")
                                )
                                .WithModifiers
                                (
                                    SyntaxFactory.TokenList
                                    (
                                        SyntaxFactory.Token(SyntaxKind.PublicKeyword)
                                    )
                                )
                                .WithParameterList
                                (
                                    SyntaxFactory.ParameterList
                                    (
                                        SyntaxFactory.SingletonSeparatedList<ParameterSyntax>
                                        (
                                            SyntaxFactory.Parameter
                                            (
                                                SyntaxFactory.Identifier("_HTML")
                                            )
                                            .WithType
                                            (
                                                SyntaxFactory.GenericName
                                                (
                                                    SyntaxFactory.Identifier("List")
                                                )
                                                .WithTypeArgumentList
                                                (
                                                    SyntaxFactory.TypeArgumentList
                                                    (
                                                        SyntaxFactory.SingletonSeparatedList<TypeSyntax>
                                                        (
                                                            SyntaxFactory.PredefinedType
                                                            (
                                                                SyntaxFactory.Token(SyntaxKind.StringKeyword)
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                                .WithBody
                                (
                                    SyntaxFactory.Block
                                    (
                                        SyntaxFactory.SingletonList<StatementSyntax>
                                        (
                                            SyntaxFactory.ExpressionStatement
                                            (
                                                SyntaxFactory.AssignmentExpression
                                                (
                                                    SyntaxKind.SimpleAssignmentExpression,
                                                    SyntaxFactory.IdentifierName("HTML"),
                                                    SyntaxFactory.IdentifierName("_HTML")
                                                )
                                            )
                                        )
                                    )
                                )
                            }
                        )
                    )
                  }

            )
        )
    )
).NormalizeWhitespace();

            string code = "";
            code = tree.ToFullString();
            return code;
        }
    }
}
